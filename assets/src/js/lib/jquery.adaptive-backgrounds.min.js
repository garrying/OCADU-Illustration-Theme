/*! Brian Gonzalez by jquery.adaptive-backgrounds.js 23-01-2014 */
!function(a){var b="data-ab-color",c="data-ab-parent",d="data-ab-css-background",e="ab-color-found",f={selector:'[data-adaptive-background="1"]',parent:null,normalizeTextColor:!1,normalizedTextColors:{light:"#fff",dark:"#000"},lumaClasses:{light:"ab-light",dark:"ab-dark"}};!function(a){"use strict";var b=function(){return document.createElement("canvas").getContext("2d")},c=function(a,c){var d=new Image,e=a.src||a;"data:"!==e.substring(0,5)&&(d.crossOrigin="Anonymous"),d.onload=function(){var a=b();a.drawImage(d,0,0);var e=a.getImageData(0,0,d.width,d.height);c&&c(e.data)},d.src=e},d=function(a){return["rgb(",a,")"].join("")},e=function(a){return a.map(function(a){return d(a.name)})},f=5,g=10,h={};h.colors=function(a,b,h){c(a,function(a){for(var c=a.length,i={},j="",k=[],l={dominant:{name:"",count:0},palette:Array.apply(null,Array(h||g)).map(Boolean).map(function(){return{name:"0,0,0",count:0}})},m=0;c>m;){if(k[0]=a[m],k[1]=a[m+1],k[2]=a[m+2],j=k.join(","),i[j]=j in i?i[j]+1:1,"0,0,0"!==j&&"255,255,255"!==j){var n=i[j];n>l.dominant.count?(l.dominant.name=j,l.dominant.count=n):l.palette.some(function(a){return n>a.count?(a.name=j,a.count=n,!0):void 0})}m+=4*f}b&&b({dominant:d(l.dominant.name),palette:e(l.palette)})})},a.RGBaster=a.RGBaster||h}(window),a.adaptiveBackground={run:function(g){var h=a.extend({},f,g);a(h.selector).each(function(){var f=a(this),g=function(){var a=i()?j():f[0];RGBaster.colors(a,function(a){f.attr(b,a.dominant),f.trigger(e,{color:a.dominant,palette:a.palette})},20)},i=function(){return f.attr(d)},j=function(){return f.css("background-image").replace("url(","").replace(")","")};f.on(e,function(a,b){var d,e=b;d=i()?f:f.attr(c)?f.parents(f.attr(c)):h.parent?f.parents(h.parent):f.parent(),d.css({backgroundColor:b.color});var g=function(){var a=e.color.match(/\d+/g);return(299*a[0]+587*a[1]+114*a[2])/1e3},j=function(a){return g(a)>=128?h.normalizedTextColors.dark:h.normalizedTextColors.light},k=function(a){return g(a)<=128?h.lumaClasses.dark:h.lumaClasses.light};h.normalizeTextColor&&d.css({color:j(b.color)}),d.addClass(k(b.color))}),g()})}}}(jQuery);